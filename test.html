<img id="imageToShare" src="public/kaguya2.jpg" alt="Gambar Keren" width="200">
<button id="shareButton">Bagikan Gambar</button>

<script>
    document.getElementById('shareButton').addEventListener('click', async () => {
        const imageUrl = document.getElementById('imageToShare').src;
        console.log(imageUrl)
        const imageTitle = document.getElementById('imageToShare').alt;
        const textToShare = "Lihat gambar keren ini dari web!";

        if (navigator.share) {
            try {
                // 1. Ambil data gambar dari URL sebagai Blob
                const response = await fetch(imageUrl);
                const blob = await response.blob();
                
                // Tentukan nama file yang akan dibagikan (penting)
                const fileName = 'gambar_web.jpg'; 

                // 2. Buat objek File dari Blob
                const fileToShare = new File([blob], fileName, { type: blob.type });
                console.table(fileToShare)

                // 3. Siapkan objek data untuk berbagi
                const shareData = {
                    files: [fileToShare], // Sertakan file
                    title: imageTitle,
                    text: textToShare,
                    // Anda juga bisa menyertakan URL (misalnya, URL halaman saat ini)
                    // url: window.location.href, 
                };

                // 4. Periksa apakah data (termasuk file) dapat dibagikan
                if (navigator.canShare && navigator.canShare(shareData)) {
                    await navigator.share(shareData);
                    console.log('Gambar berhasil dibagikan');
                } else {
                    console.warn('Browser/Sistem tidak mendukung berbagi file melalui Web Share API atau data tidak dapat dibagikan.');
                    // Terapkan fallback (misalnya, unduh atau hanya berbagi URL)
                    alert("Berbagi file tidak didukung. Coba unduh atau bagikan URL.");
                }

            } catch (error) {
                // Tangani kasus ketika pengguna membatalkan (AbortError) atau ada masalah lain
                if (error.name !== 'AbortError') {
                    console.error('Error saat berbagi:', error);
                }
            }
        } else {
            // Fallback untuk browser yang tidak mendukung Web Share API
            alert("Web Share API tidak didukung di browser ini.");
        }
    });
</script>